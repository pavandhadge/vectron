# Vectron environment tuning reference
# Format: FLAG=value  # component | default | effect | file
# Note: Many flags are optional. Defaults shown are from code.

# ===== Global runtime (all services) =====
VECTRON_GOMAXPROCS=  # global | default=auto | Set GOMAXPROCS | shared/runtimeutil/runtimeutil.go

# Profiling (worker, apigateway, placementdriver)
PPROF_MUTEX_FRACTION=  # worker/apigw/pd | default=0 | runtime.SetMutexProfileFraction | worker/cmd/worker/main.go, apigateway/cmd/apigateway/main.go, placementdriver/cmd/placementdriver/main.go
PPROF_BLOCK_RATE=  # worker/apigw/pd | default=0 | runtime.SetBlockProfileRate | same as above
PPROF_CPU_PATH=  # worker/apigw/pd | default=unset | write CPU profile to file | same as above
PPROF_CPU_SECONDS=15  # worker/apigw/pd | default=15 | CPU profile duration seconds | same as above
PPROF_MUTEX_PATH=  # worker/apigw/pd | default=unset | write mutex profile to file | same as above
PPROF_MUTEX_SECONDS=15  # worker/apigw/pd | default=15 | mutex profile duration seconds | same as above
PPROF_BLOCK_PATH=  # worker/apigw/pd | default=unset | write block profile to file | same as above
PPROF_BLOCK_SECONDS=15  # worker/apigw/pd | default=15 | block profile duration seconds | same as above

# ===== API Gateway =====
GRPC_ADDR=:8081  # apigateway | default=:8081 | gRPC listen addr | apigateway/cmd/apigateway/config.go
GRPC_TLS_ENABLED=false  # apigateway | default=false | enable gRPC TLS | apigateway/cmd/apigateway/config.go
GRPC_TLS_CERT_FILE=  # apigateway | default=empty | gRPC TLS cert path | apigateway/cmd/apigateway/config.go
GRPC_TLS_KEY_FILE=  # apigateway | default=empty | gRPC TLS key path | apigateway/cmd/apigateway/config.go
GRPC_TLS_SERVER_NAME=  # apigateway | default=empty | gRPC TLS server name override | apigateway/cmd/apigateway/config.go
HTTP_ADDR=:8080  # apigateway | default=:8080 | HTTP listen addr | apigateway/cmd/apigateway/config.go
HTTP_TLS_ENABLED=false  # apigateway | default=false | enable HTTP TLS | apigateway/cmd/apigateway/config.go
HTTP_TLS_CERT_FILE=  # apigateway | default=empty | HTTP TLS cert path | apigateway/cmd/apigateway/config.go
HTTP_TLS_KEY_FILE=  # apigateway | default=empty | HTTP TLS key path | apigateway/cmd/apigateway/config.go
PLACEMENT_DRIVER=placement:6300  # apigateway | default=placement:6300 | PD address | apigateway/cmd/apigateway/config.go
JWT_SECRET=CHANGE_ME_IN_PRODUCTION  # apigateway | default=CHANGE_ME_IN_PRODUCTION | JWT signing secret | apigateway/cmd/apigateway/config.go
MANAGEMENT_AUTH_ENABLED=true  # apigateway | default=true | require auth for management endpoints | apigateway/cmd/apigateway/config.go
MANAGEMENT_AUTH_ALLOW_SDK=false  # apigateway | default=false | allow SDK JWTs for management endpoints | apigateway/cmd/apigateway/config.go
AUTH_SERVICE_ADDR=auth:50051  # apigateway | default=auth:50051 | Auth service address | apigateway/cmd/apigateway/config.go
RERANKER_SERVICE_ADDR=localhost:50051  # apigateway | default=localhost:50051 | Reranker service address | apigateway/cmd/apigateway/config.go
FEEDBACK_DB_PATH=./data/feedback.db  # apigateway | default=./data/feedback.db | feedback SQLite path | apigateway/cmd/apigateway/config.go
RATE_LIMIT_RPS=100  # apigateway | default=100 | rate limit per second | apigateway/cmd/apigateway/config.go
SEARCH_LINEARIZABLE=false  # apigateway | default=false | linearizable reads | apigateway/cmd/apigateway/config.go
RERANK_TIMEOUT_MS=75  # apigateway | default=75 | rerank timeout ms | apigateway/cmd/apigateway/config.go
RERANK_ENABLED=false  # apigateway | default=false | enable reranking | apigateway/cmd/apigateway/config.go
RERANK_MODE=rule  # apigateway | default=rule | rerank mode (rule/llm/rl) | apigateway/cmd/apigateway/config.go
RERANK_COLLECTIONS=  # apigateway | default=empty | allowlist collections for rerank | apigateway/cmd/apigateway/config.go
RERANK_TOP_N_OVERRIDES=  # apigateway | default=empty | per-collection topN overrides (k=v) | apigateway/cmd/apigateway/config.go
RERANK_TIMEOUT_OVERRIDES=  # apigateway | default=empty | per-collection timeout overrides (k=v) | apigateway/cmd/apigateway/config.go
GRPC_ENABLE_COMPRESSION=false  # apigateway | default=false | gzip on outbound gRPC | apigateway/cmd/apigateway/config.go
GRPC_MAX_RECV_MB=256  # apigateway+worker | default=256 | max gRPC recv size | apigateway/cmd/apigateway/config.go, worker/cmd/worker/main.go
GRPC_MAX_SEND_MB=256  # apigateway+worker | default=256 | max gRPC send size | apigateway/cmd/apigateway/config.go, worker/cmd/worker/main.go
RERANK_WARMUP_ENABLED=false  # apigateway | default=false | warmup rerank cache | apigateway/cmd/apigateway/config.go
RERANK_WARMUP_TTL_MS=30000  # apigateway | default=30000 | warmup cache TTL | apigateway/cmd/apigateway/config.go
RERANK_WARMUP_MAX_SIZE=2000  # apigateway | default=2000 | warmup cache size | apigateway/cmd/apigateway/config.go
RERANK_WARMUP_CONCURRENCY=2  # apigateway | default=2 | warmup concurrency | apigateway/cmd/apigateway/config.go
SEARCH_CONSISTENCY_OVERRIDES=  # apigateway | default=empty | per-collection consistency (collection=linearizable/eventual) | apigateway/cmd/apigateway/config.go
SEARCH_CACHE_TTL_MS=0  # apigateway | default=0 | in-memory search cache TTL | apigateway/cmd/apigateway/config.go
SEARCH_CACHE_MAX_SIZE=0  # apigateway | default=0 | in-memory search cache size | apigateway/cmd/apigateway/config.go
SEARCH_CACHE_ENABLED=true  # apigateway | default=true | enable in-memory search cache | apigateway/cmd/apigateway/config.go
SEARCH_FANOUT_ENABLED=true  # apigateway | default=true | fanout across shards | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_ADDR=  # apigateway | default=empty | Redis/Valkey addr | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_PASSWORD=  # apigateway | default=empty | Redis password | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_DB=0  # apigateway | default=0 | Redis DB | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_TTL_MS=5000  # apigateway | default=5000 | Redis TTL | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_TIMEOUT_MS=8  # apigateway | default=8 | Redis timeout ms | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_SEARCH_ENABLED=true  # apigateway | default=true | enable distributed cache | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_POOL_SIZE=0  # apigateway | default=0 | Redis pool size | apigateway/cmd/apigateway/config.go
DISTRIBUTED_CACHE_MIN_IDLE_CONNS=0  # apigateway | default=0 | Redis min idle conns | apigateway/cmd/apigateway/config.go
ROUTING_CACHE_TTL_MS=30000  # apigateway | default=30000 | routing cache TTL | apigateway/cmd/apigateway/config.go
WORKER_LIST_CACHE_TTL_MS=30000  # apigateway | default=30000 | worker list cache TTL | apigateway/cmd/apigateway/config.go
RESOLVE_CACHE_TTL_MS=30000  # apigateway | default=30000 | resolve cache TTL | apigateway/cmd/apigateway/config.go
PREFER_SEARCH_ONLY_WORKERS=true  # apigateway | default=true | prefer search-only workers | apigateway/cmd/apigateway/config.go
WORKER_ROLE_CACHE_TTL_MS=5000  # apigateway | default=5000 | worker role cache TTL | apigateway/cmd/apigateway/config.go
GATEWAY_DEBUG_LOGS=false  # apigateway | default=false | verbose gateway logs | apigateway/cmd/apigateway/config.go
GATEWAY_LOG_SAMPLE_EVERY=100  # apigateway | default=100 | log sampling | apigateway/cmd/apigateway/config.go
RAW_SPEED_MODE=false  # apigateway | default=false | disable costly features | apigateway/cmd/apigateway/config.go
VECTRON_GW_ROUTE_CONCURRENCY=  # apigateway | default=adaptive | route concurrency | apigateway/cmd/apigateway/main.go
VECTRON_GW_SEND_CONCURRENCY=  # apigateway | default=adaptive | send concurrency | apigateway/cmd/apigateway/main.go
VECTRON_GW_SEARCH_CONCURRENCY=  # apigateway | default=adaptive | search concurrency | apigateway/cmd/apigateway/main.go
GRPC_MAX_STREAMS=1024  # apigateway+worker | default=1024 | max gRPC streams | apigateway/cmd/apigateway/main.go, worker/cmd/worker/main.go

# ===== Worker =====
VECTRON_SEARCH_ONLY=0  # worker | default=0 | run in search-only mode | worker/cmd/worker/main.go
VECTRON_SEARCH_ONLY_COLLECTIONS=  # worker | default=empty | collections served by search-only | worker/internal/searchonly/manager.go
VECTRON_WAL_STREAM_ENABLED=0  # worker | default=0 | enable WAL stream | worker/cmd/worker/main.go
VECTRON_WRITE_SPEED_MODE=0  # worker | default=0 | aggressive write tuning | worker/internal/storage/db.go, worker/internal/shard/state_machine.go
VECTRON_DURABILITY_PROFILE=  # worker | default=empty | "relaxed" or default | worker/internal/shard/hnsw_defaults.go
VECTRON_DISABLE_DISK_PREALLOC=0  # worker | default=0 | best-effort minimize disk preallocation | worker/internal/shard/state_machine.go, worker/cmd/worker/main.go
VECTRON_WRITE_BUFFER_MB=32  # worker | default=32 | memtable size for Pebble/WAL prealloc | worker/internal/shard/state_machine.go
PEBBLE_MEMTABLE_MB=128  # worker | default=128 | Pebble memtable MB (fallback) | worker/internal/storage/db.go
PEBBLE_MEMTABLE_STOP=4  # worker | default=4 | memtable stop threshold | worker/internal/storage/db.go
PEBBLE_L0_COMPACT=8  # worker | default=8 | L0 compaction threshold | worker/internal/storage/db.go
PEBBLE_L0_STOP=24  # worker | default=24 | L0 stop writes threshold | worker/internal/storage/db.go
PEBBLE_CACHE_MB=512  # worker | default=512 | Pebble block cache size | worker/internal/storage/db.go
VECTRON_PEBBLE_DISABLE_WAL=0  # worker | default=0 | disable Pebble WAL (unsafe) | worker/internal/storage/db.go
VECTRON_INGEST_MODE=0  # worker | default=0 | skip HNSW updates during ingest | worker/internal/shard/state_machine.go
VECTRON_SEARCH_WAIT_INDEX_MS=0  # worker | default=0 | wait for async indexing | worker/internal/storage/storage.go
VECTRON_INDEX_BATCH_SIZE=4096  # worker | default=4096 | async index batch size | worker/internal/shard/hnsw_defaults.go
VECTRON_INDEX_QUEUE_SIZE=200000  # worker | default=200000 | async index queue size | worker/internal/shard/hnsw_defaults.go
VECTRON_INDEX_AUTO_TUNE=0  # worker | default=0 | auto-tune index batch/queue sizes | worker/internal/shard/hnsw_defaults.go
VECTRON_INDEX_FLUSH_MS=200  # worker | default=200 | async index flush interval ms | worker/internal/shard/hnsw_defaults.go
VECTRON_HOT_INDEX_ENABLED=0  # worker | default=0 | enable hot in-memory index | worker/internal/shard/hnsw_defaults.go
VECTRON_HOT_INDEX_MAX=30000  # worker | default=30000 | hot index max size | worker/internal/shard/hnsw_defaults.go
VECTRON_HOT_INDEX_COLD_EF_SCALE=0.6  # worker | default=0.6 | cold ef scale | worker/internal/shard/hnsw_defaults.go
VECTRON_HNSW_NEIGHBOR_CAP=  # worker | default=0 (disabled) | cap neighbors during search | worker/internal/idxhnsw/search.go
VECTRON_DOT_CGO_BATCH=0  # worker | default=0 | enable SIMD batching | worker/internal/idxhnsw/dot_cgo_config.go
VECTRON_DOT_CGO_BATCH_MIN=32  # worker | default=32 | min batch size | worker/internal/idxhnsw/dot_cgo_config.go
VECTRON_DOT_CGO_MIN_DIM=128  # worker | default=128 | min dim for SIMD | worker/internal/idxhnsw/dot_cgo_config.go
VECTRON_WORKER_SEARCH_CACHE_TTL_MS=200  # worker | default=200 | search cache TTL | worker/internal/grpc.go
VECTRON_WORKER_SEARCH_CACHE_MAX=0  # worker | default=0 | search cache size | worker/internal/grpc.go
VECTRON_WORKER_SEARCH_CACHE_QUANT_BITS=0  # worker | default=0 | quantize cache key | worker/internal/grpc.go
VECTRON_WORKER_DEDUPE_BROADCAST=0  # worker | default=0 | dedupe IDs in broadcast search | worker/internal/grpc.go
VECTRON_WORKER_BATCHSEARCH_CONCURRENCY=  # worker | default=adaptive | batch search concurrency | worker/internal/grpc.go
VECTRON_WORKER_SEARCH_CONCURRENCY=  # worker | default=adaptive | search concurrency | worker/internal/grpc.go
VECTRON_HNSW_SNAPSHOT_CHUNK_KB=256  # worker | default=256 | snapshot chunk size | worker/internal/grpc.go
VECTRON_WAL_STREAM_BATCH_MAX=256  # worker | default=256 | WAL stream batch size | worker/internal/grpc.go
VECTRON_WAL_STREAM_FLUSH_MS=25  # worker | default=25 | WAL stream flush | worker/internal/grpc.go
VECTRON_WAL_STREAM_BACKFILL_SLEEP_MS=0  # worker | default=0 | WAL backfill sleep | worker/internal/grpc.go
VECTRON_WAL_POLL_MS=500  # worker | default=500 | WAL polling interval | worker/internal/grpc.go
VECTRON_WAL_STREAM_SUB_BUF=4096  # worker | default=4096 | WAL stream sub buffer | worker/internal/grpc.go
VECTRON_RAFT_PROPOSE_RETRIES=3  # worker | default=3 | retries on ErrSystemBusy/timeout | worker/internal/grpc.go
VECTRON_RAFT_PROPOSE_BACKOFF_MS=25  # worker | default=25 | base backoff ms between retries | worker/internal/grpc.go
VECTRON_RAFT_PROPOSE_TIMEOUT_MS=5000  # worker | default=5000 | per-attempt propose timeout ms | worker/internal/grpc.go
VECTRON_PD_WORKER_CACHE_MS=5000  # worker | default=5000 | PD worker cache TTL | worker/internal/pd/client.go
VECTRON_RACK=  # worker | default=empty | rack label | worker/internal/pd/client.go
VECTRON_ZONE=  # worker | default=empty | zone label | worker/internal/pd/client.go
VECTRON_REGION=  # worker | default=empty | region label | worker/internal/pd/client.go
STORAGE_DEBUG_LOGS=0  # worker | default=0 | storage debug logs | worker/internal/storage/logging.go
STORAGE_LOG_SAMPLE_EVERY=100  # worker | default=100 | storage log sampling | worker/internal/storage/logging.go
VECTRON_DEBUG_LOGS=0  # worker | default=0 | grpc debug logs | worker/internal/grpc.go
WORKER_LOG_SAMPLE_EVERY=100  # worker | default=100 | grpc log sampling | worker/internal/grpc.go
VECTRON_LOGDB_PROFILE=small  # worker+pd | default=small (overridden) | logdb preset | worker/cmd/worker/main.go, placementdriver/internal/raft/raft.go
VECTRON_LOGDB_WRITE_BUFFER_MB=  # worker+pd | default=profile | logdb write buffer MB | worker/cmd/worker/main.go, placementdriver/internal/raft/raft.go
VECTRON_LOGDB_MAX_WRITE_BUFFERS=  # worker+pd | default=profile | logdb max write buffers | worker/cmd/worker/main.go, placementdriver/internal/raft/raft.go
VECTRON_LOGDB_KEEP_LOGS=  # worker+pd | default=profile | keep log files | worker/cmd/worker/main.go, placementdriver/internal/raft/raft.go
VECTRON_LOGDB_RECYCLE_LOGS=  # worker+pd | default=profile | recycle log files | worker/cmd/worker/main.go, placementdriver/internal/raft/raft.go

# ===== Placement Driver =====
VECTRON_DEFAULT_SHARDS=16  # placementdriver | default=16 | initial shards for new collection | placementdriver/internal/server/server.go
VECTRON_REPLICATION_FACTOR=2  # placementdriver | default=2 | replication factor | placementdriver/internal/fsm/health.go

# ===== Auth Service =====
GRPC_PORT=:8081  # auth | default=:8081 | gRPC listen addr | auth/service/cmd/auth/main.go
GRPC_TLS_ENABLED=false  # auth | default=false | enable gRPC TLS | auth/service/cmd/auth/main.go
GRPC_TLS_CERT_FILE=  # auth | default=empty | gRPC TLS cert path | auth/service/cmd/auth/main.go
GRPC_TLS_KEY_FILE=  # auth | default=empty | gRPC TLS key path | auth/service/cmd/auth/main.go
GRPC_TLS_SERVER_NAME=  # auth | default=empty | gRPC TLS server name override | auth/service/cmd/auth/main.go
HTTP_PORT=:8082  # auth | default=:8082 | HTTP listen addr | auth/service/cmd/auth/main.go
HTTP_TLS_ENABLED=false  # auth | default=false | enable HTTP TLS | auth/service/cmd/auth/main.go
HTTP_TLS_CERT_FILE=  # auth | default=empty | HTTP TLS cert path | auth/service/cmd/auth/main.go
HTTP_TLS_KEY_FILE=  # auth | default=empty | HTTP TLS key path | auth/service/cmd/auth/main.go
ETCD_ENDPOINTS=localhost:2379  # auth | default=localhost:2379 | etcd endpoints | auth/service/cmd/auth/main.go
JWT_SECRET=  # auth | required | JWT secret (min 32 chars) | auth/service/cmd/auth/main.go
CORS_ALLOWED_ORIGINS=  # auth | default=empty | comma-separated origins | auth/service/cmd/auth/main.go

# ===== Reranker =====
RERANKER_PORT=50051  # reranker | default=50051 | gRPC port | reranker/cmd/reranker/main.go
RERANKER_STRATEGY=rule  # reranker | default=rule | strategy (rule/llm/rl) | reranker/cmd/reranker/main.go
CACHE_BACKEND=memory  # reranker | default=memory | cache backend (memory/redis) | reranker/cmd/reranker/main.go
RULE_CONFIG_PATH=  # reranker | default=empty | JSON config path | reranker/cmd/reranker/main.go
# Rule strategy tuning (reranker/internal/strategies/rule/config.go)
RULE_EXACT_MATCH_BOOST=
RULE_FUZZY_MATCH_BOOST=
RULE_TITLE_BOOST=
RULE_RECENCY_BOOST=
RULE_RECENCY_DAYS=
RULE_TFIDF_WEIGHT=
RULE_ORIGINAL_WEIGHT=
RULE_METADATA_BOOSTS=
RULE_METADATA_PENALTIES=
RULE_STOP_WORDS=
RULE_CASE_SENSITIVE=
# Reranker cache (reranker/internal/cache/factory.go)
CACHE_MAX_SIZE=
CACHE_DEFAULT_TTL=
CACHE_CLEANUP_INTERVAL=
CACHE_EVICTION_POLICY=
CACHE_STATS_ENABLED=true
CACHE_MAX_MEMORY_MB=
CACHE_BACKGROUND_CLEANUP=true
REDIS_ADDRESS=
REDIS_PASSWORD=
REDIS_DATABASE=
REDIS_POOL_SIZE=
REDIS_DIAL_TIMEOUT=
REDIS_READ_TIMEOUT=
REDIS_WRITE_TIMEOUT=
REDIS_KEY_PREFIX=

# ===== Benchmarks / Tests =====
BENCH_PROFILE_DIR=  # tests | where to write profiles | tests/benchmark/benchmark_research_test.go
MARKET_DIMS=  # tests | override dims | tests/benchmark/benchmark_market_test.go
MARKET_DATASET=50000  # tests | dataset size | tests/benchmark/benchmark_market_test.go
MARKET_DURATION_SEC=180  # tests | duration seconds | tests/benchmark/benchmark_market_test.go
MARKET_CONCURRENCY=32  # tests | concurrency | tests/benchmark/benchmark_market_test.go
MARKET_WRITE_BATCH=200  # tests | write batch size | tests/benchmark/benchmark_market_test.go
MARKET_TOPK=10  # tests | topK | tests/benchmark/benchmark_market_test.go
